
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Pad Printing Analysis</title><meta name="generator" content="MATLAB 9.13"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2023-08-17"><meta name="DC.source" content="PadPrinting2022.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outline:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Pad Printing Analysis</h1><!--introduction--><p>Tyler Jones  08/08/2023</p><div><ul><li>This program reads data from the TD11840- excel files and analyzes how different metrics have evolved in time.</li><li>For more details, please visit: <a href="https://tjjones6.github.io/CadenceInternship/padPrinting.html">https://tjjones6.github.io/CadenceInternship/padPrinting.html</a></li></ul></div><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Read Data and Write Basic Calculations to Command Window</a></li><li><a href="#2">Average Calculations</a></li><li><a href="#3">Gross Scrap Cost</a></li><li><a href="#4">Average scrap cost</a></li><li><a href="#5">Plot Scrap Per Good Part</a></li><li><a href="#6">Recent Scrap Per Good Part (Animated)</a></li><li><a href="#7">Gross Scrap Cost vs Time (Animated)</a></li><li><a href="#8">Good Parts vs Time</a></li><li><a href="#9">Gross Good Parts</a></li><li><a href="#10">Gross Good Parts vs Time (Animated)</a></li><li><a href="#11">Good Parts % vs Time (Animated)</a></li><li><a href="#12">Gross Bad Parts (Animated)</a></li><li><a href="#13">Bad Parts % vs Time (Animated)</a></li><li><a href="#14">Gross Bad Parts vs Time (Animated)</a></li></ul></div><h2 id="1">Read Data and Write Basic Calculations to Command Window</h2><pre class="codeinput">close <span class="string">all</span>;
clear;
clc;

<span class="comment">% Read data in from excel as a table</span>
GoodPartsTable_2022 = readtable(<span class="string">'TD11840_2022.xlsx'</span>,<span class="string">'Range'</span>,<span class="string">'H42:H95'</span>);
BadPartsTable_2022 = readtable(<span class="string">'TD11840_2022.xlsx'</span>,<span class="string">'Range'</span>,<span class="string">'I42:I95'</span>);
GoodPartsTable_2023 = readtable(<span class="string">'TD11840_2023.xlsx'</span>,<span class="string">'Range'</span>,<span class="string">'H56:H128'</span>);
BadPartsTable_2023 = readtable(<span class="string">'TD11840_2023.xlsx'</span>,<span class="string">'Range'</span>,<span class="string">'I56:I128'</span>);

ScrapTable_2022 = readtable(<span class="string">'TD11840_2022.xlsx'</span>,<span class="string">'Range'</span>,<span class="string">'L42:L95'</span>);
Scrap_2022 = table2array(ScrapTable_2022);
ScrapTable_2023 = readtable(<span class="string">'TD11840_2023.xlsx'</span>,<span class="string">'Range'</span>,<span class="string">'L56:L128'</span>);
Scrap_2023 = table2array(ScrapTable_2023);

ScrapCostTable_2022 = readtable(<span class="string">'TD11840_2022.xlsx'</span>,<span class="string">'Range'</span>,<span class="string">'K42:K95'</span>);
ScrapCostTable_2023 = readtable(<span class="string">'TD11840_2023.xlsx'</span>,<span class="string">'Range'</span>,<span class="string">'K56:K128'</span>);

<span class="comment">% Sum of Good and Bad Parts</span>
GoodParts_2022 = table2array(GoodPartsTable_2022)';
TotalGoodParts_2022 = sum(GoodParts_2022);
BadParts_2022 = table2array(BadPartsTable_2022)';
TotalBadParts_2022 = sum(BadParts_2022);
Days_2022 = 1:length(GoodParts_2022);

GoodParts_2023 = table2array(GoodPartsTable_2023)';
TotalGoodParts_2023 = sum(GoodParts_2023);
BadParts_2023 = table2array(BadPartsTable_2023)';
TotalBadParts_2023 = sum(BadParts_2023);
Days_2023 = 1:length(GoodParts_2023);

ScrapCost_2022 = table2array(ScrapCostTable_2022)';
TotalScrapCost_2022 = sum(ScrapCost_2022);
ScrapCost_2023 = table2array(ScrapCostTable_2023)';
TotalScrapCost_2023 = sum(ScrapCost_2023);

<span class="comment">% Averages</span>
AveGoodParts_2022 = TotalGoodParts_2022/length(GoodParts_2022);
AveBadParts_2022 = TotalBadParts_2022/length(BadParts_2022);

AveGoodParts_2023 = TotalGoodParts_2023/length(GoodParts_2023);
AveBadParts_2023 = TotalBadParts_2023/length(BadParts_2023);

DiffAveGoodParts = abs(AveGoodParts_2023-AveGoodParts_2022);

<span class="comment">% Scrap Percentage</span>
ScrapPercentage_2022 = 100*TotalBadParts_2022/(TotalGoodParts_2022+ <span class="keyword">...</span>
    TotalBadParts_2022);
SP_2022 = sprintf(<span class="string">'2022 Scrap Percentage: %.2f%%'</span>, <span class="keyword">...</span>
    ScrapPercentage_2022);
disp(SP_2022);

SC_2022 = sprintf(<span class="string">'2022 Total Scrap Cost: $%.2f '</span>, <span class="keyword">...</span>
    TotalScrapCost_2022);
disp(SC_2022);

ScrapPercentage_2023 = 100*TotalBadParts_2023/(TotalGoodParts_2023+ <span class="keyword">...</span>
    TotalBadParts_2023);
SP_2023 = sprintf(<span class="string">'2023 Scrap Percentage: %.2f%%'</span>, <span class="keyword">...</span>
    ScrapPercentage_2023);
disp(SP_2023);

SC_2023 = sprintf(<span class="string">'2023 Total Scrap Cost: $%.2f '</span>, <span class="keyword">...</span>
    TotalScrapCost_2023);
disp(SC_2023);
</pre><pre class="codeoutput">2022 Scrap Percentage: 1.92%
2022 Total Scrap Cost: $1267.59 
2023 Scrap Percentage: 8.10%
2023 Total Scrap Cost: $4024.37 
</pre><h2 id="2">Average Calculations</h2><pre class="codeinput">GoodPartsNow_2022 = zeros(size(1:length(Days_2022)));
<span class="keyword">for</span> i = 1:length(Days_2022)
    GoodPartsNow_2022(i) = sum(GoodParts_2022(1:i));
<span class="keyword">end</span>

BadPartsNow_2022 = zeros(size(1:length(Days_2022)));
<span class="keyword">for</span> i = 1:length(Days_2022)
    BadPartsNow_2022(i) = sum(BadParts_2022(1:i));
<span class="keyword">end</span>

GoodPartsNow_2023 = zeros(size(1:length(Days_2023)));
<span class="keyword">for</span> i = 1:length(Days_2023)
    GoodPartsNow_2023(i) = sum(GoodParts_2023(1:i));
<span class="keyword">end</span>

BadPartsNow_2023 = zeros(size(1:length(Days_2023)));
<span class="keyword">for</span> i = 1:length(Days_2023)
    BadPartsNow_2023(i) = sum(BadParts_2023(1:i));
<span class="keyword">end</span>

ScrapCostNow_2022 = zeros(size(1:length(Days_2022)));
<span class="keyword">for</span> i = 1:length(Days_2022)
    ScrapCostNow_2022(i) = sum(ScrapCost_2022(1:i));
<span class="keyword">end</span>

AveScrapCostNow_2022 = zeros(size(1:length(Days_2022)));
<span class="keyword">for</span> i = 1:length(Days_2022)
    AveScrapCostNow_2022(i) = sum(ScrapCost_2022(1:i)/Days_2022(i));
<span class="keyword">end</span>

ScrapCostNow_2023 = zeros(size(1:length(Days_2023)));
<span class="keyword">for</span> i = 1:length(Days_2023)
    ScrapCostNow_2023(i) = sum(ScrapCost_2023(1:i));
<span class="keyword">end</span>

AveScrapCostNow_2023 = zeros(size(1:length(Days_2023)));
<span class="keyword">for</span> i = 1:length(Days_2023)
    AveScrapCostNow_2023(i) = sum(ScrapCost_2023(1:i)/Days_2023(i));
<span class="keyword">end</span>

AveScrapCost_2022 = TotalScrapCost_2022/length(Days_2022);
AveScrapCost_2023 = TotalScrapCost_2023/length(Days_2023);
</pre><h2 id="3">Gross Scrap Cost</h2><pre class="codeinput">figure
plot(Days_2022,ScrapCostNow_2022);
hold <span class="string">on</span>
plot(Days_2023,ScrapCostNow_2023);
xlabel(<span class="string">'Time'</span>)
ylabel(<span class="string">'Scrap Cost'</span>)
title(<span class="string">'Scrap Cost vs Time'</span>)
legend(<span class="string">'2022 Scrap Cost'</span>,<span class="string">'2023 Scrap Cost'</span>,Location=<span class="string">'nw'</span>)
</pre><img vspace="5" hspace="5" src="PadPrinting2022_01.png" alt=""> <h2 id="4">Average scrap cost</h2><pre class="codeinput">figure
plot(Days_2022,AveScrapCostNow_2022);
hold <span class="string">on</span>
<span class="comment">% plot(Days_2022,ones(size(1:length(Days_2022)))*AveScrapCost_2022)</span>
plot(Days_2023,AveScrapCostNow_2023);
<span class="comment">% plot(Days_2023,ones(size(1:length(Days_2023)))*AveScrapCost_2023)</span>
xlabel(<span class="string">'Time'</span>)
ylabel(<span class="string">'Average Scrap Cost'</span>)
title(<span class="string">'Moving Average Scrap Cost vs Time'</span>)
legend(<span class="string">'2022 Moving Avg Scrap Cost'</span>,<span class="string">'2023 Moving Avg Scrap Cost'</span>)
</pre><img vspace="5" hspace="5" src="PadPrinting2022_02.png" alt=""> <h2 id="5">Plot Scrap Per Good Part</h2><pre class="codeinput">ScrapPercNowAnim_2022 = NaN(1,max(Days_2022),<span class="string">'single'</span>);
ScrapPercNowAnim_2023 = NaN(1,max(Days_2022),<span class="string">'single'</span>);
ScrapPercDiff = NaN(1,max(Days_2022),<span class="string">'single'</span>);
ScrapPercAvg_2022 = NaN(1,max(Days_2022),<span class="string">'single'</span>);
ScrapPercAvg_2023 = NaN(1,max(Days_2022),<span class="string">'single'</span>);
ScrapPercAvgDiff = NaN(1,max(Days_2022),<span class="string">'single'</span>);
n = 100;

ScrapPercFig = figure(<span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="string">'position'</span>,[0 0 1440 1080]);
<span class="keyword">for</span> j = 1:length(Days_2022)
    clf

    <span class="comment">% ScrapPercNowAnim_2022(j) = sum(ScrapCost_2022(1:j))/(sum(BadParts_2022(1:j) + GoodParts_2022(1:j)));</span>
    ScrapPercNowAnim_2022(j) = sum(ScrapCost_2022(1:j))/(sum(GoodParts_2022(1:j)));
    ScrapPercAvg_2022(j) = mean(ScrapPercNowAnim_2022(1:j));
    <span class="comment">% ScrapPercNowAnim_2023(j) = sum(ScrapCost_2023(1:j))/(sum(BadParts_2023(1:j) + GoodParts_2023(1:j)));</span>
    ScrapPercNowAnim_2023(j) = sum(ScrapCost_2023(1:j))/(sum(GoodParts_2023(1:j)));
    ScrapPercAvg_2023(j) = mean(ScrapPercNowAnim_2023(1:j));
    ScrapPercDiff(j) = abs(ScrapPercAvg_2023(j) - ScrapPercNowAnim_2022(j));
    ScrapPercAvgDiff(j) = abs(ScrapPercAvg_2023(j) - ScrapPercAvg_2022(j));

    plot(Days_2022,ScrapPercNowAnim_2022,<span class="string">'Color'</span>,<span class="string">'blue'</span>);
    hold <span class="string">on</span>
    plot(Days_2022,ScrapPercNowAnim_2023,<span class="string">'Color'</span>,<span class="string">'red'</span>);
    plot(Days_2022,ScrapPercAvg_2022,<span class="string">"-."</span>,<span class="string">'Color'</span>,<span class="string">'black'</span>);
    plot(Days_2022,ScrapPercAvg_2023,<span class="string">"-."</span>,<span class="string">'Color'</span>,<span class="string">'black'</span>);
    text(1,(26+3)/n, sprintf(<span class="string">'2022 Normalized Scrap Cost ($/good part): $%.3f'</span>,ScrapPercNowAnim_2022(j)))
    text(1,(25.5+3)/n, sprintf(<span class="string">'2023 Time-Equivalent Normalized Scrap Cost ($/ good part): $%.3f'</span>,ScrapPercNowAnim_2023(j)))
    text(1,(25+3)/n, sprintf(<span class="string">'Average Normalized Scrap Cost Difference: $%.3f'</span>,ScrapPercAvgDiff(j)))
    text(1,(24.5+3)/n, sprintf(<span class="string">'Absolute Normalized Scrap Cost Difference: $%.3f'</span>,ScrapPercDiff(j)))

    xlim([0 54])
    ylim([0 (30+3)/n])
    xlabel(<span class="string">'Time'</span>)
    ylabel(<span class="string">'Normalized Scrap Cost ($/good part)'</span>)
    title(<span class="string">'Normalized Scrap Cost vs Time'</span>)
    legend(<span class="string">'2022 Normalized Scrap Cost'</span>,<span class="string">'2023 Normalized Scrap Cost'</span>,<span class="string">'2022 Average'</span>,<span class="string">'2023 Average'</span>,Location=<span class="string">'nw'</span>)
    movieVector(j) = getframe(ScrapPercFig);
<span class="keyword">end</span>
    myWriter = VideoWriter(<span class="string">'ScrapPercentageVsTime'</span>,<span class="string">'MPEG-4'</span>);
    myWriter.FrameRate = 5;
    open(myWriter);
    writeVideo(myWriter, movieVector);
    close(myWriter);
    clc
</pre><img vspace="5" hspace="5" src="PadPrinting2022_03.png" alt=""> <h2 id="6">Recent Scrap Per Good Part (Animated)</h2><pre class="codeinput">DaysTable_Recent = readtable(<span class="string">"TD11840_2023.xlsx"</span>,<span class="string">'Range'</span>,<span class="string">'M117:M128'</span>);
Days_Recent = table2array(DaysTable_Recent)';
AvgArray_2022 = zeros(length(Days_Recent),1) + ScrapPercAvg_2022(end);
AvgArray_2023 = zeros(length(Days_Recent),1) + ScrapPercAvg_2023(end);
ScrapPercNowAnimShortAvg_2023 = NaN(1,length(Days_Recent),<span class="string">'single'</span>);
ScrapCostShort_2023 = table2array(readtable(<span class="string">"TD11840_2023.xlsx"</span>,<span class="string">'Range'</span>,<span class="string">'K117:K128'</span>));
GoodPartsShort_2023 = table2array(readtable(<span class="string">"TD11840_2023.xlsx"</span>,<span class="string">'Range'</span>,<span class="string">'H117:H128'</span>));

ScrapPercShortFig = figure(<span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="string">'position'</span>,[0 0 1440 1080]);
<span class="keyword">for</span> j = 1:length(Days_Recent)
    clf

    ScrapPercNowAnimShortAvg_2023(j) = sum(ScrapCostShort_2023(1:j))/(sum(GoodPartsShort_2023(1:j)));

    hold <span class="string">on</span>
    plot(Days_Recent,AvgArray_2022,<span class="string">'Color'</span>,<span class="string">'blue'</span>);
    plot(Days_Recent,AvgArray_2023,<span class="string">'Color'</span>,<span class="string">'blue'</span>);
    plot(Days_Recent,ScrapPercNowAnimShortAvg_2023,<span class="string">'Color'</span>,<span class="string">'red'</span>);
    text(62.25, 0.22, sprintf(<span class="string">'2022 Average Normalized Scrap Cost ($/good part): $%.3f'</span>,AvgArray_2022(j)))
    text(62.25,0.21, sprintf(<span class="string">'2023 Average Time-Equivalent Normalized Scrap Cost ($/ good part): $%.3f'</span>,AvgArray_2023(j)))
    text(62.25, 0.20, sprintf(<span class="string">'New Average Normalized Scrap Cost: $%.3f'</span>,ScrapPercNowAnimShortAvg_2023(j)))

    xlim([62 73])
    ylim([0 .25])
    xlabel(<span class="string">'Time'</span>)
    ylabel(<span class="string">'Normalized Scrap Cost ($/good part)'</span>)
    title(<span class="string">'New Normalized Scrap Cost vs Time'</span>)
    legend(<span class="string">'2022 Average Normalized Scrap Cost'</span>,<span class="string">'2023 Average Normalized Scrap Cost'</span>,<span class="string">'New Normalized Scrap Cost'</span>,Location=<span class="string">'nw'</span>)
    movieVectorNew(j) = getframe(ScrapPercShortFig);
<span class="keyword">end</span>
    newWriter = VideoWriter(<span class="string">'ScrapPercentageShortVsTime'</span>,<span class="string">'MPEG-4'</span>);
    newWriter.FrameRate = 5;
    open(newWriter);
    writeVideo(newWriter, movieVectorNew);
    close(newWriter);
    clc
</pre><img vspace="5" hspace="5" src="PadPrinting2022_04.png" alt=""> <h2 id="7">Gross Scrap Cost vs Time (Animated)</h2><pre class="codeinput">ScrapCostNowAnim_2022 = NaN(1,54,<span class="string">'single'</span>);
ScrapCostNowAnim_2023 = NaN(1,54,<span class="string">'single'</span>);
ScrapCostDiff = NaN(1,54,<span class="string">'single'</span>);

ScrapCostFig = figure(<span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="string">'position'</span>,[0 0 1440 1080]);
<span class="keyword">for</span> j = 1:length(Days_2022)
    clf

    ScrapCostNowAnim_2022(j) = sum(ScrapCost_2022(1:j));
    ScrapCostNowAnim_2023(j) = sum(ScrapCost_2023(1:j));
    ScrapCostDiff(j) = abs(ScrapCostNowAnim_2023(j) - ScrapCostNowAnim_2022(j));

    plot(Days_2022,ScrapCostNowAnim_2022);
    hold <span class="string">on</span>
    plot(Days_2022,ScrapCostNowAnim_2023);
    text(1,4100, sprintf(<span class="string">'2022 Total Scrap Cost: $%.2f'</span>,ScrapCostNowAnim_2022(j)))
    text(1,4000, sprintf(<span class="string">'2023 Time-Equivalent Total Scrap Cost: $%.2f'</span>,ScrapCostNowAnim_2023(j)))
    text(15.25,4000, sprintf(<span class="string">' of $%.2f'</span>,TotalScrapCost_2023))
    text(1,3900, sprintf(<span class="string">'Absolute Scrap Cost Difference: $%.2f'</span>,ScrapCostDiff(j)))

    xlim([0 54])
    ylim([0 4500])
    xlabel(<span class="string">'Time'</span>)
    ylabel(<span class="string">'Scrap Cost'</span>)
    title(<span class="string">'Scrap Cost vs Time'</span>)
    legend(<span class="string">'2022 Scrap Cost'</span>,<span class="string">'2023 Scrap Cost'</span>,Location=<span class="string">'nw'</span>)
    movieVector(j) = getframe(ScrapCostFig);
<span class="keyword">end</span>
    myWriter = VideoWriter(<span class="string">'ScrapCostVsTime'</span>,<span class="string">'MPEG-4'</span>);
    myWriter.FrameRate = 5;
    open(myWriter);
    writeVideo(myWriter, movieVector);
    close(myWriter);
    clc
</pre><img vspace="5" hspace="5" src="PadPrinting2022_05.png" alt=""> <h2 id="8">Good Parts vs Time</h2><pre class="codeinput">figure
plot(Days_2022,GoodParts_2022);
hold <span class="string">on</span>
plot(Days_2023,GoodParts_2023);
CONSTANT_1 = size(1,Days_2022)*AveGoodParts_2022;
CONSTANT_2 = size(1,Days_2023)*AveGoodParts_2023;
plot(Days_2022,CONSTANT_1);
plot(Days_2023,CONSTANT_2);
xlim([0 length(GoodParts_2023)])
xlabel(<span class="string">'Day'</span>)
ylabel(<span class="string">'Number of Good Parts'</span>)
title(<span class="string">'Good Parts vs Time'</span>)
legend(<span class="string">'2022 Good Parts'</span>,<span class="string">'2023 Good Parts'</span>,<span class="string">'2022 Average'</span>,<span class="string">'2023 Average'</span>)
</pre><img vspace="5" hspace="5" src="PadPrinting2022_06.png" alt=""> <h2 id="9">Gross Good Parts</h2><pre class="codeinput">figure
plot(Days_2022,GoodPartsNow_2022);
hold <span class="string">on</span>
plot(Days_2023,GoodPartsNow_2023);
xlabel(<span class="string">'Time'</span>)
ylabel(<span class="string">'Number of Parts'</span>)
title(<span class="string">'Good Parts vs Time'</span>)
legend(<span class="string">'2022 Good Parts'</span>,<span class="string">'2023 Good Parts'</span>,Location=<span class="string">'nw'</span>)
</pre><img vspace="5" hspace="5" src="PadPrinting2022_07.png" alt=""> <h2 id="10">Gross Good Parts vs Time (Animated)</h2><pre class="codeinput">GoodPartsNowAnim_2022 = NaN(1,54,<span class="string">'single'</span>);
GoodPartsNowAnim_2023 = NaN(1,54,<span class="string">'single'</span>);
GoodPartsDiff = NaN(1,54,<span class="string">'single'</span>);

GoodPartsFig = figure(<span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="string">'position'</span>,[0 0 1440 1080]);
<span class="keyword">for</span> j = 1:length(Days_2022)
    clf

    GoodPartsNowAnim_2022(j) = sum(GoodParts_2022(1:j));
    GoodPartsNowAnim_2023(j) = sum(GoodParts_2023(1:j));
    GoodPartsDiff(j) = abs(GoodPartsNowAnim_2023(j) - GoodPartsNowAnim_2022(j));

    plot(Days_2022,GoodPartsNowAnim_2022,<span class="string">'Color'</span>,<span class="string">'Blue'</span>);
    hold <span class="string">on</span>
    plot(Days_2022,GoodPartsNowAnim_2023,<span class="string">'Color'</span>,<span class="string">'Red'</span>);
    text(1,37000, sprintf(<span class="string">'2022 Good Parts: %.0f'</span>,GoodPartsNowAnim_2022(j)))
    text(1,36000, sprintf(<span class="string">'2023 Time-Equivalent Good Parts: %.0f'</span>,GoodPartsNowAnim_2023(j)))
    text(12.85,36000, sprintf(<span class="string">' of %.0f'</span>,TotalGoodParts_2023))
    text(1,35000, sprintf(<span class="string">'Absolute Good Parts Difference: %.0f'</span>,GoodPartsDiff(j)))

    xlim([0 54])
    ylim([0 40000])
    xlabel(<span class="string">'Time'</span>)
    ylabel(<span class="string">'Number of Good Parts'</span>)
    title(<span class="string">'Good Parts vs Time'</span>)
    legend(<span class="string">'2022 Good Parts'</span>,<span class="string">'2023 Good Parts'</span>,Location=<span class="string">'nw'</span>)
    movieVector(j) = getframe(GoodPartsFig);
<span class="keyword">end</span>
    myWriter = VideoWriter(<span class="string">'GoodPartsVsTime'</span>,<span class="string">'MPEG-4'</span>);
    myWriter.FrameRate = 5;
    open(myWriter);
    writeVideo(myWriter, movieVector);
    close(myWriter);
    clc
</pre><img vspace="5" hspace="5" src="PadPrinting2022_08.png" alt=""> <h2 id="11">Good Parts % vs Time (Animated)</h2><pre class="codeinput">PercBadPartsNowAnim_2022 = NaN(1,max(Days_2022),<span class="string">'single'</span>);
PercBadPartsNowAnim_2023 = NaN(1,max(Days_2022),<span class="string">'single'</span>);
PercBadPartsDiff = NaN(1,max(Days_2022),<span class="string">'single'</span>);
PercBadPartAvg_2022 = NaN(1,max(Days_2022),<span class="string">'single'</span>);
PercBadPartAvg_2023 = NaN(1,max(Days_2022),<span class="string">'single'</span>);
PercBadPartAvgDiff = NaN(1,max(Days_2022),<span class="string">'single'</span>);

PercBadPartsFig = figure(<span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="string">'position'</span>,[0 0 1440 1080]);
<span class="keyword">for</span> j = 1:length(Days_2022)
    clf

    PercBadPartsNowAnim_2022(j) = 100*sum(GoodParts_2022(1:j))/(sum(BadParts_2022(1:j) + GoodParts_2022(1:j)));
    PercBadPartAvg_2022(j) = mean(PercBadPartsNowAnim_2022(1:j));
    PercBadPartsNowAnim_2023(j) = 100*sum(GoodParts_2023(1:j))/(sum(BadParts_2023(1:j) + GoodParts_2023(1:j)));
    PercBadPartAvg_2023(j) = mean(PercBadPartsNowAnim_2023(1:j));
    PercBadPartsDiff(j) = abs(PercBadPartsNowAnim_2023(j) - PercBadPartsNowAnim_2022(j));
    PercBadPartAvgDiff(j) = abs(PercBadPartAvg_2023(j) - PercBadPartAvg_2022(j));

    plot(Days_2022,PercBadPartsNowAnim_2022,<span class="string">'Color'</span>,<span class="string">'blue'</span>);
    hold <span class="string">on</span>
    plot(Days_2022,PercBadPartsNowAnim_2023,<span class="string">'Color'</span>,<span class="string">'red'</span>);
    plot(Days_2022,PercBadPartAvg_2022,<span class="string">"-."</span>,<span class="string">'Color'</span>,<span class="string">'black'</span>);
    plot(Days_2022,PercBadPartAvg_2023,<span class="string">"-."</span>,<span class="string">'Color'</span>,<span class="string">'black'</span>);
    text(1,102, sprintf(<span class="string">'2022 Good Part Percentage: %.2f'</span>,PercBadPartsNowAnim_2022(j)))
    text(1,101.5, sprintf(<span class="string">'2023 Time-Equivalent Good Parts Percentage: %.2f'</span>,PercBadPartsNowAnim_2023(j)))
    text(1,101, sprintf(<span class="string">'Average Good Part Percentage Difference: %.2f'</span>,PercBadPartAvgDiff(j)))
    text(1,100.5, sprintf(<span class="string">'Absolute Good Part Percentage Difference: %.2f'</span>,PercBadPartsDiff(j)))

    xlim([0 54])
    ylim([80 105])
    xlabel(<span class="string">'Time'</span>)
    ylabel(<span class="string">'Good Part Percentage'</span>)
    title(<span class="string">'Good Part Percentage vs Time'</span>)
    legend(<span class="string">'2022 Good Part Percentage'</span>,<span class="string">'2023 Good Part Percentage'</span>,<span class="string">'2022 Average'</span>,<span class="string">'2023 Average'</span>,Location=<span class="string">'nw'</span>)
    movieVector(j) = getframe(PercBadPartsFig);
<span class="keyword">end</span>
    myWriter = VideoWriter(<span class="string">'PercGoodPartsVsTime'</span>,<span class="string">'MPEG-4'</span>);
    myWriter.FrameRate = 5;
    open(myWriter);
    writeVideo(myWriter, movieVector);
    close(myWriter);
    clc
</pre><img vspace="5" hspace="5" src="PadPrinting2022_09.png" alt=""> <h2 id="12">Gross Bad Parts (Animated)</h2><pre class="codeinput">figure
plot(Days_2022,BadPartsNow_2022);
hold <span class="string">on</span>
plot(Days_2023,BadPartsNow_2023);
xlabel(<span class="string">'Time'</span>)
ylabel(<span class="string">'Number of Parts'</span>)
title(<span class="string">'Bad Parts vs Time'</span>)
legend(<span class="string">'2022 Bad Parts'</span>,<span class="string">'2023 Bad Parts'</span>,Location=<span class="string">'nw'</span>)
</pre><img vspace="5" hspace="5" src="PadPrinting2022_10.png" alt=""> <h2 id="13">Bad Parts % vs Time (Animated)</h2><pre class="codeinput">PercBadPartsNowAnim_2022 = NaN(1,max(Days_2022),<span class="string">'single'</span>);
PercBadPartsNowAnim_2023 = NaN(1,max(Days_2022),<span class="string">'single'</span>);
PercBadPartsDiff = NaN(1,max(Days_2022),<span class="string">'single'</span>);
PercBadPartAvg_2022 = NaN(1,max(Days_2022),<span class="string">'single'</span>);
PercBadPartAvg_2023 = NaN(1,max(Days_2022),<span class="string">'single'</span>);
PercBadPartAvgDiff = NaN(1,max(Days_2022),<span class="string">'single'</span>);

PercBadPartsFig = figure(<span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="string">'position'</span>,[0 0 1440 1080]);
<span class="keyword">for</span> j = 1:length(Days_2022)
    clf

    PercBadPartsNowAnim_2022(j) = 100*sum(BadParts_2022(1:j))/(sum(BadParts_2022(1:j) + GoodParts_2022(1:j)));
    PercBadPartAvg_2022(j) = mean(PercBadPartsNowAnim_2022(1:j));
    PercBadPartsNowAnim_2023(j) = 100*sum(BadParts_2023(1:j))/(sum(BadParts_2023(1:j) + GoodParts_2023(1:j)));
    PercBadPartAvg_2023(j) = mean(PercBadPartsNowAnim_2023(1:j));
    PercBadPartsDiff(j) = abs(PercBadPartsNowAnim_2023(j) - PercBadPartsNowAnim_2022(j));
    PercBadPartAvgDiff(j) = abs(PercBadPartAvg_2023(j) - PercBadPartAvg_2022(j));

    plot(Days_2022,PercBadPartsNowAnim_2022,<span class="string">'Color'</span>,<span class="string">'blue'</span>);
    hold <span class="string">on</span>
    plot(Days_2022,PercBadPartsNowAnim_2023,<span class="string">'Color'</span>,<span class="string">'red'</span>);
    plot(Days_2022,PercBadPartAvg_2022,<span class="string">"-."</span>,<span class="string">'Color'</span>,<span class="string">'black'</span>);
    plot(Days_2022,PercBadPartAvg_2023,<span class="string">"-."</span>,<span class="string">'Color'</span>,<span class="string">'black'</span>);
    text(1,17.5, sprintf(<span class="string">'2022 Bad Part Percentage: %.2f'</span>,PercBadPartsNowAnim_2022(j)))
    text(1,17, sprintf(<span class="string">'2023 Time-Equivalent Bad Parts Percentage: %.2f'</span>,PercBadPartsNowAnim_2023(j)))
    text(1,16.5, sprintf(<span class="string">'Average Bad Part Percentage Difference: %.2f'</span>,PercBadPartAvgDiff(j)))
    text(1,16, sprintf(<span class="string">'Absolute Bad Part Percentage Difference: %.2f'</span>,PercBadPartsDiff(j)))

    xlim([0 54])
    ylim([0 20])
    xlabel(<span class="string">'Time'</span>)
    ylabel(<span class="string">'Bad Part Percentage'</span>)
    title(<span class="string">'Bad Part Percentage vs Time'</span>)
    legend(<span class="string">'2022 Bad Part Percentage'</span>,<span class="string">'2023 Bad Part Percentage'</span>,<span class="string">'2022 Average'</span>,<span class="string">'2023 Average'</span>,Location=<span class="string">'nw'</span>)
    movieVector(j) = getframe(PercBadPartsFig);
<span class="keyword">end</span>
    myWriter = VideoWriter(<span class="string">'PercBadPartsVsTime'</span>,<span class="string">'MPEG-4'</span>);
    myWriter.FrameRate = 5;
    open(myWriter);
    writeVideo(myWriter, movieVector);
    close(myWriter);
    clc
</pre><img vspace="5" hspace="5" src="PadPrinting2022_11.png" alt=""> <h2 id="14">Gross Bad Parts vs Time (Animated)</h2><pre class="codeinput">BadPartsNowAnim_2022 = NaN(1,54,<span class="string">'single'</span>);
BadPartsNowAnim_2023 = NaN(1,54,<span class="string">'single'</span>);
BadPartsDiff = NaN(1,54,<span class="string">'single'</span>);

BadPartsFig = figure(<span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="string">'position'</span>,[0 0 1440 1080]);
<span class="keyword">for</span> j = 1:length(Days_2022)
    clf

    BadPartsNowAnim_2022(j) = sum(BadParts_2022(1:j));
    BadPartsNowAnim_2023(j) = sum(BadParts_2023(1:j));
    BadPartsDiff(j) = abs(BadPartsNowAnim_2023(j) - BadPartsNowAnim_2022(j));

    plot(Days_2022,BadPartsNowAnim_2022,<span class="string">'Color'</span>,<span class="string">'Blue'</span>);
    hold <span class="string">on</span>
    plot(Days_2022,BadPartsNowAnim_2023,<span class="string">'Color'</span>,<span class="string">'Red'</span>);
    text(1,2100, sprintf(<span class="string">'2022 Bad Parts: %.0f'</span>,BadPartsNowAnim_2022(j)))
    text(1,2050, sprintf(<span class="string">'2023 Time-Equivalent Bad Parts: %.0f'</span>,BadPartsNowAnim_2023(j)))
    text(12.1,2050, sprintf(<span class="string">' of %.0f'</span>,TotalBadParts_2023))
    text(1,2000, sprintf(<span class="string">'Absolute Bad Parts Difference: %.0f'</span>,BadPartsDiff(j)))

    xlim([0 54])
    ylim([0 2300])
    xlabel(<span class="string">'Time'</span>)
    ylabel(<span class="string">'Number of Bad Parts'</span>)
    title(<span class="string">'Bad Parts vs Time'</span>)
    legend(<span class="string">'2022 Bad Parts'</span>,<span class="string">'2023 Bad Parts'</span>,Location=<span class="string">'nw'</span>)
    movieVector(j) = getframe(BadPartsFig);
<span class="keyword">end</span>
    myWriter = VideoWriter(<span class="string">'BadPartsVsTime'</span>,<span class="string">'MPEG-4'</span>);
    myWriter.FrameRate = 5;
    open(myWriter);
    writeVideo(myWriter, movieVector);
    close(myWriter);
    clc
</pre><img vspace="5" hspace="5" src="PadPrinting2022_12.png" alt=""> <p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2022b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Pad Printing Analysis
% Tyler Jones || 08/08/2023
%
% * This program reads data from the TD11840- excel files and analyzes how different metrics have evolved in time.
% * For more details, please visit: <https://tjjones6.github.io/CadenceInternship/padPrinting.html> 
%

%% Read Data and Write Basic Calculations to Command Window
close all;
clear;
clc;

% Read data in from excel as a table
GoodPartsTable_2022 = readtable('TD11840_2022.xlsx','Range','H42:H95');
BadPartsTable_2022 = readtable('TD11840_2022.xlsx','Range','I42:I95');
GoodPartsTable_2023 = readtable('TD11840_2023.xlsx','Range','H56:H128');
BadPartsTable_2023 = readtable('TD11840_2023.xlsx','Range','I56:I128');

ScrapTable_2022 = readtable('TD11840_2022.xlsx','Range','L42:L95');
Scrap_2022 = table2array(ScrapTable_2022);
ScrapTable_2023 = readtable('TD11840_2023.xlsx','Range','L56:L128');
Scrap_2023 = table2array(ScrapTable_2023);

ScrapCostTable_2022 = readtable('TD11840_2022.xlsx','Range','K42:K95');
ScrapCostTable_2023 = readtable('TD11840_2023.xlsx','Range','K56:K128');

% Sum of Good and Bad Parts
GoodParts_2022 = table2array(GoodPartsTable_2022)';
TotalGoodParts_2022 = sum(GoodParts_2022);
BadParts_2022 = table2array(BadPartsTable_2022)';
TotalBadParts_2022 = sum(BadParts_2022);
Days_2022 = 1:length(GoodParts_2022);

GoodParts_2023 = table2array(GoodPartsTable_2023)';
TotalGoodParts_2023 = sum(GoodParts_2023);
BadParts_2023 = table2array(BadPartsTable_2023)';
TotalBadParts_2023 = sum(BadParts_2023);
Days_2023 = 1:length(GoodParts_2023);

ScrapCost_2022 = table2array(ScrapCostTable_2022)';
TotalScrapCost_2022 = sum(ScrapCost_2022);
ScrapCost_2023 = table2array(ScrapCostTable_2023)';
TotalScrapCost_2023 = sum(ScrapCost_2023);

% Averages
AveGoodParts_2022 = TotalGoodParts_2022/length(GoodParts_2022);
AveBadParts_2022 = TotalBadParts_2022/length(BadParts_2022);

AveGoodParts_2023 = TotalGoodParts_2023/length(GoodParts_2023);
AveBadParts_2023 = TotalBadParts_2023/length(BadParts_2023);

DiffAveGoodParts = abs(AveGoodParts_2023-AveGoodParts_2022);

% Scrap Percentage
ScrapPercentage_2022 = 100*TotalBadParts_2022/(TotalGoodParts_2022+ ...
    TotalBadParts_2022);
SP_2022 = sprintf('2022 Scrap Percentage: %.2f%%', ...
    ScrapPercentage_2022);
disp(SP_2022);

SC_2022 = sprintf('2022 Total Scrap Cost: $%.2f ', ...
    TotalScrapCost_2022);
disp(SC_2022);

ScrapPercentage_2023 = 100*TotalBadParts_2023/(TotalGoodParts_2023+ ...
    TotalBadParts_2023);
SP_2023 = sprintf('2023 Scrap Percentage: %.2f%%', ...
    ScrapPercentage_2023);
disp(SP_2023);

SC_2023 = sprintf('2023 Total Scrap Cost: $%.2f ', ...
    TotalScrapCost_2023);
disp(SC_2023);

%% Average Calculations
GoodPartsNow_2022 = zeros(size(1:length(Days_2022)));
for i = 1:length(Days_2022)
    GoodPartsNow_2022(i) = sum(GoodParts_2022(1:i));
end

BadPartsNow_2022 = zeros(size(1:length(Days_2022)));
for i = 1:length(Days_2022)
    BadPartsNow_2022(i) = sum(BadParts_2022(1:i));
end

GoodPartsNow_2023 = zeros(size(1:length(Days_2023)));
for i = 1:length(Days_2023)
    GoodPartsNow_2023(i) = sum(GoodParts_2023(1:i));
end

BadPartsNow_2023 = zeros(size(1:length(Days_2023)));
for i = 1:length(Days_2023)
    BadPartsNow_2023(i) = sum(BadParts_2023(1:i));
end

ScrapCostNow_2022 = zeros(size(1:length(Days_2022)));
for i = 1:length(Days_2022)
    ScrapCostNow_2022(i) = sum(ScrapCost_2022(1:i));
end

AveScrapCostNow_2022 = zeros(size(1:length(Days_2022)));
for i = 1:length(Days_2022)
    AveScrapCostNow_2022(i) = sum(ScrapCost_2022(1:i)/Days_2022(i));
end

ScrapCostNow_2023 = zeros(size(1:length(Days_2023)));
for i = 1:length(Days_2023)
    ScrapCostNow_2023(i) = sum(ScrapCost_2023(1:i));
end

AveScrapCostNow_2023 = zeros(size(1:length(Days_2023)));
for i = 1:length(Days_2023)
    AveScrapCostNow_2023(i) = sum(ScrapCost_2023(1:i)/Days_2023(i));
end

AveScrapCost_2022 = TotalScrapCost_2022/length(Days_2022);
AveScrapCost_2023 = TotalScrapCost_2023/length(Days_2023);

%% Gross Scrap Cost
figure
plot(Days_2022,ScrapCostNow_2022);
hold on
plot(Days_2023,ScrapCostNow_2023);
xlabel('Time')
ylabel('Scrap Cost')
title('Scrap Cost vs Time')
legend('2022 Scrap Cost','2023 Scrap Cost',Location='nw')

%% Average scrap cost
figure
plot(Days_2022,AveScrapCostNow_2022);
hold on
% plot(Days_2022,ones(size(1:length(Days_2022)))*AveScrapCost_2022)
plot(Days_2023,AveScrapCostNow_2023);
% plot(Days_2023,ones(size(1:length(Days_2023)))*AveScrapCost_2023)
xlabel('Time')
ylabel('Average Scrap Cost')
title('Moving Average Scrap Cost vs Time')
legend('2022 Moving Avg Scrap Cost','2023 Moving Avg Scrap Cost')

%% Plot Scrap Per Good Part
ScrapPercNowAnim_2022 = NaN(1,max(Days_2022),'single');
ScrapPercNowAnim_2023 = NaN(1,max(Days_2022),'single');
ScrapPercDiff = NaN(1,max(Days_2022),'single');
ScrapPercAvg_2022 = NaN(1,max(Days_2022),'single');
ScrapPercAvg_2023 = NaN(1,max(Days_2022),'single');
ScrapPercAvgDiff = NaN(1,max(Days_2022),'single');
n = 100;

ScrapPercFig = figure('Units','pixels','position',[0 0 1440 1080]);
for j = 1:length(Days_2022)
    clf

    % ScrapPercNowAnim_2022(j) = sum(ScrapCost_2022(1:j))/(sum(BadParts_2022(1:j) + GoodParts_2022(1:j)));
    ScrapPercNowAnim_2022(j) = sum(ScrapCost_2022(1:j))/(sum(GoodParts_2022(1:j)));
    ScrapPercAvg_2022(j) = mean(ScrapPercNowAnim_2022(1:j));
    % ScrapPercNowAnim_2023(j) = sum(ScrapCost_2023(1:j))/(sum(BadParts_2023(1:j) + GoodParts_2023(1:j)));
    ScrapPercNowAnim_2023(j) = sum(ScrapCost_2023(1:j))/(sum(GoodParts_2023(1:j)));
    ScrapPercAvg_2023(j) = mean(ScrapPercNowAnim_2023(1:j));
    ScrapPercDiff(j) = abs(ScrapPercAvg_2023(j) - ScrapPercNowAnim_2022(j));
    ScrapPercAvgDiff(j) = abs(ScrapPercAvg_2023(j) - ScrapPercAvg_2022(j));

    plot(Days_2022,ScrapPercNowAnim_2022,'Color','blue');
    hold on
    plot(Days_2022,ScrapPercNowAnim_2023,'Color','red');
    plot(Days_2022,ScrapPercAvg_2022,"-.",'Color','black');
    plot(Days_2022,ScrapPercAvg_2023,"-.",'Color','black');
    text(1,(26+3)/n, sprintf('2022 Normalized Scrap Cost ($/good part): $%.3f',ScrapPercNowAnim_2022(j)))
    text(1,(25.5+3)/n, sprintf('2023 Time-Equivalent Normalized Scrap Cost ($/ good part): $%.3f',ScrapPercNowAnim_2023(j)))
    text(1,(25+3)/n, sprintf('Average Normalized Scrap Cost Difference: $%.3f',ScrapPercAvgDiff(j)))
    text(1,(24.5+3)/n, sprintf('Absolute Normalized Scrap Cost Difference: $%.3f',ScrapPercDiff(j)))

    xlim([0 54])
    ylim([0 (30+3)/n])
    xlabel('Time')
    ylabel('Normalized Scrap Cost ($/good part)')
    title('Normalized Scrap Cost vs Time')
    legend('2022 Normalized Scrap Cost','2023 Normalized Scrap Cost','2022 Average','2023 Average',Location='nw')
    movieVector(j) = getframe(ScrapPercFig);
end
    myWriter = VideoWriter('ScrapPercentageVsTime','MPEG-4');
    myWriter.FrameRate = 5;
    open(myWriter);
    writeVideo(myWriter, movieVector);
    close(myWriter);
    clc

%% Recent Scrap Per Good Part (Animated)
DaysTable_Recent = readtable("TD11840_2023.xlsx",'Range','M117:M128');
Days_Recent = table2array(DaysTable_Recent)';
AvgArray_2022 = zeros(length(Days_Recent),1) + ScrapPercAvg_2022(end);
AvgArray_2023 = zeros(length(Days_Recent),1) + ScrapPercAvg_2023(end);
ScrapPercNowAnimShortAvg_2023 = NaN(1,length(Days_Recent),'single');
ScrapCostShort_2023 = table2array(readtable("TD11840_2023.xlsx",'Range','K117:K128'));
GoodPartsShort_2023 = table2array(readtable("TD11840_2023.xlsx",'Range','H117:H128'));

ScrapPercShortFig = figure('Units','pixels','position',[0 0 1440 1080]);
for j = 1:length(Days_Recent)
    clf

    ScrapPercNowAnimShortAvg_2023(j) = sum(ScrapCostShort_2023(1:j))/(sum(GoodPartsShort_2023(1:j)));

    hold on
    plot(Days_Recent,AvgArray_2022,'Color','blue');
    plot(Days_Recent,AvgArray_2023,'Color','blue');
    plot(Days_Recent,ScrapPercNowAnimShortAvg_2023,'Color','red');
    text(62.25, 0.22, sprintf('2022 Average Normalized Scrap Cost ($/good part): $%.3f',AvgArray_2022(j)))
    text(62.25,0.21, sprintf('2023 Average Time-Equivalent Normalized Scrap Cost ($/ good part): $%.3f',AvgArray_2023(j)))
    text(62.25, 0.20, sprintf('New Average Normalized Scrap Cost: $%.3f',ScrapPercNowAnimShortAvg_2023(j)))

    xlim([62 73])
    ylim([0 .25])
    xlabel('Time')
    ylabel('Normalized Scrap Cost ($/good part)')
    title('New Normalized Scrap Cost vs Time')
    legend('2022 Average Normalized Scrap Cost','2023 Average Normalized Scrap Cost','New Normalized Scrap Cost',Location='nw')
    movieVectorNew(j) = getframe(ScrapPercShortFig);
end
    newWriter = VideoWriter('ScrapPercentageShortVsTime','MPEG-4');
    newWriter.FrameRate = 5;
    open(newWriter);
    writeVideo(newWriter, movieVectorNew);
    close(newWriter);
    clc

%% Gross Scrap Cost vs Time (Animated)
ScrapCostNowAnim_2022 = NaN(1,54,'single');
ScrapCostNowAnim_2023 = NaN(1,54,'single');
ScrapCostDiff = NaN(1,54,'single');

ScrapCostFig = figure('Units','pixels','position',[0 0 1440 1080]);
for j = 1:length(Days_2022)
    clf

    ScrapCostNowAnim_2022(j) = sum(ScrapCost_2022(1:j));
    ScrapCostNowAnim_2023(j) = sum(ScrapCost_2023(1:j));
    ScrapCostDiff(j) = abs(ScrapCostNowAnim_2023(j) - ScrapCostNowAnim_2022(j));

    plot(Days_2022,ScrapCostNowAnim_2022);
    hold on
    plot(Days_2022,ScrapCostNowAnim_2023);
    text(1,4100, sprintf('2022 Total Scrap Cost: $%.2f',ScrapCostNowAnim_2022(j)))
    text(1,4000, sprintf('2023 Time-Equivalent Total Scrap Cost: $%.2f',ScrapCostNowAnim_2023(j)))
    text(15.25,4000, sprintf(' of $%.2f',TotalScrapCost_2023))
    text(1,3900, sprintf('Absolute Scrap Cost Difference: $%.2f',ScrapCostDiff(j)))

    xlim([0 54])
    ylim([0 4500])
    xlabel('Time')
    ylabel('Scrap Cost')
    title('Scrap Cost vs Time')
    legend('2022 Scrap Cost','2023 Scrap Cost',Location='nw')
    movieVector(j) = getframe(ScrapCostFig);
end
    myWriter = VideoWriter('ScrapCostVsTime','MPEG-4');
    myWriter.FrameRate = 5;
    open(myWriter);
    writeVideo(myWriter, movieVector);
    close(myWriter);
    clc

%% Good Parts vs Time
figure
plot(Days_2022,GoodParts_2022);
hold on
plot(Days_2023,GoodParts_2023);
CONSTANT_1 = size(1,Days_2022)*AveGoodParts_2022;
CONSTANT_2 = size(1,Days_2023)*AveGoodParts_2023;
plot(Days_2022,CONSTANT_1);
plot(Days_2023,CONSTANT_2);
xlim([0 length(GoodParts_2023)])
xlabel('Day')
ylabel('Number of Good Parts')
title('Good Parts vs Time')
legend('2022 Good Parts','2023 Good Parts','2022 Average','2023 Average')

%% Gross Good Parts
figure
plot(Days_2022,GoodPartsNow_2022);
hold on
plot(Days_2023,GoodPartsNow_2023);
xlabel('Time')
ylabel('Number of Parts')
title('Good Parts vs Time')
legend('2022 Good Parts','2023 Good Parts',Location='nw')

%% Gross Good Parts vs Time (Animated)
GoodPartsNowAnim_2022 = NaN(1,54,'single');
GoodPartsNowAnim_2023 = NaN(1,54,'single');
GoodPartsDiff = NaN(1,54,'single');

GoodPartsFig = figure('Units','pixels','position',[0 0 1440 1080]);
for j = 1:length(Days_2022)
    clf

    GoodPartsNowAnim_2022(j) = sum(GoodParts_2022(1:j));
    GoodPartsNowAnim_2023(j) = sum(GoodParts_2023(1:j));
    GoodPartsDiff(j) = abs(GoodPartsNowAnim_2023(j) - GoodPartsNowAnim_2022(j));

    plot(Days_2022,GoodPartsNowAnim_2022,'Color','Blue');
    hold on
    plot(Days_2022,GoodPartsNowAnim_2023,'Color','Red');
    text(1,37000, sprintf('2022 Good Parts: %.0f',GoodPartsNowAnim_2022(j)))
    text(1,36000, sprintf('2023 Time-Equivalent Good Parts: %.0f',GoodPartsNowAnim_2023(j)))
    text(12.85,36000, sprintf(' of %.0f',TotalGoodParts_2023))
    text(1,35000, sprintf('Absolute Good Parts Difference: %.0f',GoodPartsDiff(j)))

    xlim([0 54])
    ylim([0 40000])
    xlabel('Time')
    ylabel('Number of Good Parts')
    title('Good Parts vs Time')
    legend('2022 Good Parts','2023 Good Parts',Location='nw')
    movieVector(j) = getframe(GoodPartsFig);
end
    myWriter = VideoWriter('GoodPartsVsTime','MPEG-4');
    myWriter.FrameRate = 5;
    open(myWriter);
    writeVideo(myWriter, movieVector);
    close(myWriter);
    clc

%% Good Parts % vs Time (Animated)
PercBadPartsNowAnim_2022 = NaN(1,max(Days_2022),'single');
PercBadPartsNowAnim_2023 = NaN(1,max(Days_2022),'single');
PercBadPartsDiff = NaN(1,max(Days_2022),'single');
PercBadPartAvg_2022 = NaN(1,max(Days_2022),'single');
PercBadPartAvg_2023 = NaN(1,max(Days_2022),'single');
PercBadPartAvgDiff = NaN(1,max(Days_2022),'single');

PercBadPartsFig = figure('Units','pixels','position',[0 0 1440 1080]);
for j = 1:length(Days_2022)
    clf

    PercBadPartsNowAnim_2022(j) = 100*sum(GoodParts_2022(1:j))/(sum(BadParts_2022(1:j) + GoodParts_2022(1:j)));
    PercBadPartAvg_2022(j) = mean(PercBadPartsNowAnim_2022(1:j));
    PercBadPartsNowAnim_2023(j) = 100*sum(GoodParts_2023(1:j))/(sum(BadParts_2023(1:j) + GoodParts_2023(1:j)));
    PercBadPartAvg_2023(j) = mean(PercBadPartsNowAnim_2023(1:j));
    PercBadPartsDiff(j) = abs(PercBadPartsNowAnim_2023(j) - PercBadPartsNowAnim_2022(j));
    PercBadPartAvgDiff(j) = abs(PercBadPartAvg_2023(j) - PercBadPartAvg_2022(j));

    plot(Days_2022,PercBadPartsNowAnim_2022,'Color','blue');
    hold on
    plot(Days_2022,PercBadPartsNowAnim_2023,'Color','red');
    plot(Days_2022,PercBadPartAvg_2022,"-.",'Color','black');
    plot(Days_2022,PercBadPartAvg_2023,"-.",'Color','black');
    text(1,102, sprintf('2022 Good Part Percentage: %.2f',PercBadPartsNowAnim_2022(j)))
    text(1,101.5, sprintf('2023 Time-Equivalent Good Parts Percentage: %.2f',PercBadPartsNowAnim_2023(j)))
    text(1,101, sprintf('Average Good Part Percentage Difference: %.2f',PercBadPartAvgDiff(j)))
    text(1,100.5, sprintf('Absolute Good Part Percentage Difference: %.2f',PercBadPartsDiff(j)))

    xlim([0 54])
    ylim([80 105])
    xlabel('Time')
    ylabel('Good Part Percentage')
    title('Good Part Percentage vs Time')
    legend('2022 Good Part Percentage','2023 Good Part Percentage','2022 Average','2023 Average',Location='nw')
    movieVector(j) = getframe(PercBadPartsFig);
end
    myWriter = VideoWriter('PercGoodPartsVsTime','MPEG-4');
    myWriter.FrameRate = 5;
    open(myWriter);
    writeVideo(myWriter, movieVector);
    close(myWriter);
    clc

%% Gross Bad Parts (Animated)
figure
plot(Days_2022,BadPartsNow_2022);
hold on
plot(Days_2023,BadPartsNow_2023);
xlabel('Time')
ylabel('Number of Parts')
title('Bad Parts vs Time')
legend('2022 Bad Parts','2023 Bad Parts',Location='nw')

%% Bad Parts % vs Time (Animated)
PercBadPartsNowAnim_2022 = NaN(1,max(Days_2022),'single');
PercBadPartsNowAnim_2023 = NaN(1,max(Days_2022),'single');
PercBadPartsDiff = NaN(1,max(Days_2022),'single');
PercBadPartAvg_2022 = NaN(1,max(Days_2022),'single');
PercBadPartAvg_2023 = NaN(1,max(Days_2022),'single');
PercBadPartAvgDiff = NaN(1,max(Days_2022),'single');

PercBadPartsFig = figure('Units','pixels','position',[0 0 1440 1080]);
for j = 1:length(Days_2022)
    clf

    PercBadPartsNowAnim_2022(j) = 100*sum(BadParts_2022(1:j))/(sum(BadParts_2022(1:j) + GoodParts_2022(1:j)));
    PercBadPartAvg_2022(j) = mean(PercBadPartsNowAnim_2022(1:j));
    PercBadPartsNowAnim_2023(j) = 100*sum(BadParts_2023(1:j))/(sum(BadParts_2023(1:j) + GoodParts_2023(1:j)));
    PercBadPartAvg_2023(j) = mean(PercBadPartsNowAnim_2023(1:j));
    PercBadPartsDiff(j) = abs(PercBadPartsNowAnim_2023(j) - PercBadPartsNowAnim_2022(j));
    PercBadPartAvgDiff(j) = abs(PercBadPartAvg_2023(j) - PercBadPartAvg_2022(j));

    plot(Days_2022,PercBadPartsNowAnim_2022,'Color','blue');
    hold on
    plot(Days_2022,PercBadPartsNowAnim_2023,'Color','red');
    plot(Days_2022,PercBadPartAvg_2022,"-.",'Color','black');
    plot(Days_2022,PercBadPartAvg_2023,"-.",'Color','black');
    text(1,17.5, sprintf('2022 Bad Part Percentage: %.2f',PercBadPartsNowAnim_2022(j)))
    text(1,17, sprintf('2023 Time-Equivalent Bad Parts Percentage: %.2f',PercBadPartsNowAnim_2023(j)))
    text(1,16.5, sprintf('Average Bad Part Percentage Difference: %.2f',PercBadPartAvgDiff(j)))
    text(1,16, sprintf('Absolute Bad Part Percentage Difference: %.2f',PercBadPartsDiff(j)))

    xlim([0 54])
    ylim([0 20])
    xlabel('Time')
    ylabel('Bad Part Percentage')
    title('Bad Part Percentage vs Time')
    legend('2022 Bad Part Percentage','2023 Bad Part Percentage','2022 Average','2023 Average',Location='nw')
    movieVector(j) = getframe(PercBadPartsFig);
end
    myWriter = VideoWriter('PercBadPartsVsTime','MPEG-4');
    myWriter.FrameRate = 5;
    open(myWriter);
    writeVideo(myWriter, movieVector);
    close(myWriter);
    clc

%% Gross Bad Parts vs Time (Animated)
BadPartsNowAnim_2022 = NaN(1,54,'single');
BadPartsNowAnim_2023 = NaN(1,54,'single');
BadPartsDiff = NaN(1,54,'single');

BadPartsFig = figure('Units','pixels','position',[0 0 1440 1080]);
for j = 1:length(Days_2022)
    clf

    BadPartsNowAnim_2022(j) = sum(BadParts_2022(1:j));
    BadPartsNowAnim_2023(j) = sum(BadParts_2023(1:j));
    BadPartsDiff(j) = abs(BadPartsNowAnim_2023(j) - BadPartsNowAnim_2022(j));

    plot(Days_2022,BadPartsNowAnim_2022,'Color','Blue');
    hold on
    plot(Days_2022,BadPartsNowAnim_2023,'Color','Red');
    text(1,2100, sprintf('2022 Bad Parts: %.0f',BadPartsNowAnim_2022(j)))
    text(1,2050, sprintf('2023 Time-Equivalent Bad Parts: %.0f',BadPartsNowAnim_2023(j)))
    text(12.1,2050, sprintf(' of %.0f',TotalBadParts_2023))
    text(1,2000, sprintf('Absolute Bad Parts Difference: %.0f',BadPartsDiff(j)))

    xlim([0 54])
    ylim([0 2300])
    xlabel('Time')
    ylabel('Number of Bad Parts')
    title('Bad Parts vs Time')
    legend('2022 Bad Parts','2023 Bad Parts',Location='nw')
    movieVector(j) = getframe(BadPartsFig);
end
    myWriter = VideoWriter('BadPartsVsTime','MPEG-4');
    myWriter.FrameRate = 5;
    open(myWriter);
    writeVideo(myWriter, movieVector);
    close(myWriter);
    clc
##### SOURCE END #####
--></body></html>